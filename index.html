<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Defense Attempt Detailed Tracker</title>
    <style>
        :root { --primary: #1a2a6c; --secondary: #b21f1f; --bg: #f5f7fa; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); display: flex; justify-content: center; padding: 20px; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); max-width: 800px; width: 100%; }
        h2 { color: var(--primary); text-align: center; border-bottom: 3px solid var(--secondary); display: inline-block; width: 100%; padding-bottom: 10px; }
        .form-group { margin: 20px 0; }
        label { font-weight: 600; color: #333; }
        input, select { width: 100%; padding: 12px; margin-top: 8px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; }
        button { width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.3s; font-size: 16px; }
        button:hover { background: var(--secondary); }
        .results { margin-top: 30px; }
        .exam-section { margin-bottom: 25px; border: 1px solid #eee; border-radius: 10px; padding: 15px; background: #fff; }
        .exam-header { font-size: 18px; font-weight: bold; color: var(--primary); border-bottom: 1px solid #eee; padding-bottom: 5px; margin-bottom: 10px; display: flex; justify-content: space-between; }
        .attempt-tag { font-size: 13px; padding: 4px 10px; background: #e8f5e9; color: #2e7d32; border-radius: 20px; margin: 3px; display: inline-block; }
        .expired-tag { background: #ffebee; color: #c62828; }
        .total-badge { background: var(--secondary); color: white; padding: 2px 10px; border-radius: 5px; font-size: 14px; }
    </style>
</head>
<body>

<div class="card">
    <h2>Defense Exam Attempt List</h2>
    
    <div class="form-group">
        <label>Select Date of Birth:</label>
        <input type="date" id="dob" value="2003-01-01">
    </div>

    <div class="form-group">
        <label>Category (For CAPF Relaxation):</label>
        <select id="category">
            <option value="0">General / EWS</option>
            <option value="3">OBC (+3 Years)</option>
            <option value="5">SC/ST (+5 Years)</option>
        </select>
    </div>

    <button onclick="generateAttempts()">Calculate My Timeline</button>

    <div id="results" class="results"></div>
</div>

<script>
    function generateAttempts() {
        const dobVal = document.getElementById('dob').value;
        if(!dobVal) return;
        const dob = new Date(dobVal);
        const categoryBonus = parseInt(document.getElementById('category').value);
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = "";

        const exams = [
            { name: "NDA", min: 16.5, max: 19.5, freq: 2 },
            { name: "CDS (IMA/INA)", min: 19, max: 24, freq: 2 },
            { name: "CDS (AFA)", min: 20, max: 24, freq: 2 },
            { name: "CDS (OTA)", min: 19, max: 25, freq: 2 },
            { name: "AFCAT (Flying)", min: 20, max: 24, freq: 2 },
            { name: "AFCAT (Ground Duty)", min: 20, max: 26, freq: 2 },
            { name: "CAPF (Assistant Commandant)", min: 20, max: 25 + categoryBonus, freq: 1 }
        ];

        exams.forEach(exam => {
            let attemptList = [];
            // We check for cycles from 2026 to 2035
            for (let year = 2026; year <= 2035; year++) {
                if (exam.freq === 2) {
                    // Cycle 1: Joins Jan 1 of Year+1
                    const doj1 = new Date(year + 1, 0, 1);
                    if (isValid(dob, doj1, exam.min, exam.max)) {
                        attemptList.push(`${exam.name} I - ${year} (DOJ: Jan ${year + 1})`);
                    }
                    // Cycle 2: Joins July 1 of Year+1
                    const doj2 = new Date(year + 1, 6, 1);
                    if (isValid(dob, doj2, exam.min, exam.max)) {
                        attemptList.push(`${exam.name} II - ${year} (DOJ: July ${year + 1})`);
                    }
                } else {
                    // CAPF: Age as of Aug 1st of Exam Year
                    const doj = new Date(year, 7, 1);
                    if (isValid(dob, doj, exam.min, exam.max)) {
                        attemptList.push(`CAPF AC ${year} (Ref: Aug ${year})`);
                    }
                }
            }

            // Render Exam Section
            const section = document.createElement('div');
            section.className = 'exam-section';
            
            let attemptsHtml = attemptList.length > 0 
                ? attemptList.map(a => `<span class="attempt-tag">${a}</span>`).join('')
                : `<span class="attempt-tag expired-tag">No attempts remaining based on age</span>`;

            section.innerHTML = `
                <div class="exam-header">
                    ${exam.name} 
                    <span class="total-badge">${attemptList.length} Left</span>
                </div>
                <div class="attempt-container">${attemptsHtml}</div>
            `;
            resultsDiv.appendChild(section);
        });
    }

    function isValid(dob, doj, min, max) {
        let age = (doj - dob) / (1000 * 60 * 60 * 24 * 365.25);
        return age >= min && age < max;
    }
</script>

</body>
</html>
